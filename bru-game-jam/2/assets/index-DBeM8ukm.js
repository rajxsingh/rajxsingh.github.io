var e=Object.defineProperty,t=(t,i,s)=>((t,i,s)=>i in t?e(t,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[i]=s)(t,"symbol"!=typeof i?i+"":i,s);import{r as i}from"./phaser-UvlxNa5i.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const i of e)if("childList"===i.type)for(const e of i.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var s=i();class a extends s.Scene{constructor(){super("Boot")}preload(){}create(){this.scene.start("Preloader")}}class r extends s.Scene{constructor(){super("Game"),t(this,"refBeta"),t(this,"refGamma"),t(this,"isLandscapePrimary"),t(this,"isLandscapeSecondary"),t(this,"moveX"),t(this,"moveY"),t(this,"camera"),t(this,"background"),t(this,"msg_text"),t(this,"duck"),t(this,"cursors"),t(this,"developers",[]),t(this,"developerRoles",[{role:"Frontend",aura:10},{role:"Backend",aura:15},{role:"Designer",aura:8},{role:"QA",aura:12},{role:"DevOps",aura:20}]),t(this,"gameDuration",60),t(this,"timeLeft"),t(this,"auraPoints"),t(this,"gameOver")}create(){this.refBeta=null,this.refGamma=null,this.timeLeft=this.gameDuration,this.auraPoints=0,this.gameOver=!1,window.addEventListener("deviceorientation",this.handleOrientation.bind(this)),window.addEventListener("orientationchange",this.updateOrientation.bind(this)),this.updateOrientation(),this.camera=this.cameras.main,this.camera.setBackgroundColor(3329330);const e=this.make.tilemap({key:"map"}),t=e.addTilesetImage("tilemap-template-32px-grid-dark","tiles"),i=e.createLayer("Tile Layer 1",t,0,0),s=(this.scale.width-i.width)/2,a=(this.scale.height-i.height)/2;i.setPosition(s,a),this.duck=this.physics.add.sprite(45,45,"duck"),this.duck.setDisplaySize(24,28),this.duck.setCollideWorldBounds(!0),this.anims.create({key:"idle",frames:this.anims.generateFrameNumbers("duck",{start:0,end:1}),frameRate:1,repeat:-1}),this.anims.create({key:"walk",frames:this.anims.generateFrameNumbers("duck",{start:6,end:11}),frameRate:8,repeat:-1}),i.forEachTile((e=>{var t;if(!e||-1===e.index||!e.tileset||!e.tileset.tileData)return;const i=e.tileset.tileData[e.index-e.tileset.firstgid];(null==(t=null==i?void 0:i.objectgroup)?void 0:t.objects)&&i.objectgroup.objects.forEach((t=>{const i=t.properties||[],s=i.some((e=>"collides"===e.name&&e.value)),a=i.some((e=>"developer"===e.name&&e.value)),r=e.getLeft()+t.x+t.width/2,o=e.getTop()+t.y+t.height/2;if(s){const e=this.physics.add.staticImage(r,o,null);e.body.setSize(t.width,t.height),e.setVisible(!1),this.physics.add.collider(this.duck,e)}if(a){const e=Phaser.Utils.Array.GetRandom(this.developerRoles),i=e.role,s=e.aura,a=this.add.rectangle(r,o,t.width,t.height,6447714);a.setOrigin(.5),a.role=i,a.aura=s,a.triggered=!1;const n=this.add.text(r,o-20,`${i}`,{fontSize:"10px",backgroundColor:"#fff",color:"#000",padding:{x:4,y:2}});n.setOrigin(.5),n.setVisible(!1),this.developers.push({sprite:a,text:n});const h=()=>{this.developers.filter((e=>e.sprite.triggered)).length>=10||Phaser.Math.Distance.Between(this.duck.x,this.duck.y,a.x,a.y)>=40&&!a.triggered&&(a.triggered=!0,a.setFillStyle(16711680),n.setVisible(!0),this.time.delayedCall(Phaser.Math.Between(2e4,3e4),(()=>{a.triggered&&(a.triggered=!1,a.setFillStyle(6447714),n.setVisible(!1))})))};this.time.addEvent({delay:Phaser.Math.Between(5e3,45e3),loop:!0,callback:h})}}))})),this.auraText=this.add.text(10,10,`Aura: ${this.auraPoints}`,{fontSize:"16px",color:"#ffffff",backgroundColor:"rgba(0,0,0,0.4)",padding:{x:6,y:4}}).setScrollFactor(0),this.timerText=this.add.text(this.scale.width-10,10,`Time: ${this.timeLeft}`,{fontSize:"16px",color:"#ffffff",backgroundColor:"rgba(0,0,0,0.4)",padding:{x:6,y:4}}).setOrigin(1,0).setScrollFactor(0),this.time.addEvent({delay:1e3,loop:!0,callback:()=>{this.gameOver||(this.timeLeft--,this.timerText.setText(`Time: ${this.timeLeft}`),this.timeLeft<=0&&this.endGame())}}),this.cursors=this.input.keyboard.createCursorKeys()}updateOrientation(){const e=(screen.orientation||{}).type||"";this.isLandscapePrimary="landscape-primary"===e,this.isLandscapeSecondary="landscape-secondary"===e,this.refBeta=null,this.refGamma=null}calibrate(e){this.refBeta=e.beta||0,this.refGamma=e.gamma||0}handleOrientation(e){null!==this.refBeta&&null!==this.refGamma||this.calibrate(e);const t=e.beta||0,i=e.gamma||0,s=t-this.refBeta,a=i-this.refGamma;this.isLandscapePrimary||this.isLandscapeSecondary?this.isLandscapePrimary?(this.moveX=s/30,this.moveY=-a/30):this.isLandscapeSecondary&&(this.moveX=-s/30,this.moveY=a/30):(this.moveX=a/30,this.moveY=s/30),this.moveX=Math.max(-1,Math.min(1,this.moveX)),this.moveY=Math.max(-1,Math.min(1,this.moveY))}endGame(){this.gameOver=!0,this.add.rectangle(this.scale.width/2,this.scale.height/2,this.scale.width,this.scale.height,0,.7).setScrollFactor(0),this.add.text(this.scale.width/2,this.scale.height/2-20,`Time's up!\nTotal Aura Points: ${this.auraPoints}`,{fontSize:"24px",color:"#ffffff",align:"center"}).setOrigin(.5),this.add.text(this.scale.width/2,this.scale.height/2+40,"Click or Press Any Key to Restart",{fontSize:"16px",color:"#cccccc"}).setOrigin(.5),this.input.once("pointerdown",(()=>this.scene.restart())),this.input.keyboard.once("keydown",(()=>this.scene.restart()))}update(){var e;if(!this.cursors||this.gameOver)return;const t=200;this.duck.setVelocity(0),this.duck.anims.play("idle",!0),this.cursors.left.isDown?(this.duck.setVelocityX(-200),this.duck.anims.play("walk",!0),this.duck.setFlipX(!0)):this.cursors.right.isDown&&(this.duck.setVelocityX(t),this.duck.anims.play("walk",!0),this.duck.setFlipX(!1)),this.cursors.up.isDown?(this.duck.setVelocityY(-200),this.duck.anims.play("walk",!0)):this.cursors.down.isDown&&(this.duck.setVelocityY(t),this.duck.anims.play("walk",!0)),(this.moveX||this.moveY)&&(this.duck.setVelocityX(this.moveX*t*2),this.duck.setVelocityY(this.moveY*t*2),this.duck.anims.play("walk",!0),this.moveX<0?this.duck.setFlipX(!0):this.moveX>0&&this.duck.setFlipX(!1)),null==(e=this.developers)||e.forEach((e=>{Phaser.Math.Distance.Between(this.duck.x,this.duck.y,e.sprite.x,e.sprite.y)<40&&e.sprite.triggered&&(e.sprite.triggered=!1,e.sprite.setFillStyle(6447714),e.text.setVisible(!1),this.auraPoints+=e.sprite.aura,this.auraText.setText(`Aura: ${this.auraPoints}`))}))}}class o extends s.Scene{constructor(){super("Intro")}create(){const e=this.scale.width/2,t=this.scale.height/2;this.cameras.main.setBackgroundColor(3329330),this.add.text(e,100,"BruDuck",{fontFamily:"Arial Black",fontSize:48,color:"#53A1AD",stroke:"#ffffff",strokeThickness:8,align:"center"}).setOrigin(.5);const i=this.add.sprite(e,t-50,"duck");i.setDisplaySize(48,56),this.anims.create({key:"walk_intro",frames:this.anims.generateFrameNumbers("duck",{start:6,end:11}),frameRate:6,repeat:-1}),i.play("walk_intro"),this.add.text(e,t+60,"Meet our office helper duck!\nDevelopers keep running into trouble.\nHelp them regain their calm and collect Aura points!",{fontFamily:"Arial",fontSize:20,color:"#ffffff",align:"center",wordWrap:{width:600}}).setOrigin(.5),this.add.text(e,this.scale.height-80,"Start",{fontFamily:"Arial Black",fontSize:28,color:"#53A1AD",stroke:"#ffffff",strokeThickness:4}).setOrigin(.5).setInteractive().on("pointerdown",(async()=>{if("function"==typeof DeviceMotionEvent.requestPermission)try{await DeviceMotionEvent.requestPermission()}catch(e){console.error("Motion request failed:",e)}this.scene.start("Game")}))}}class n extends s.Scene{constructor(){super("Preloader")}init(){this.add.rectangle(512,384,468,32).setStrokeStyle(1,16777215);const e=this.add.rectangle(282,384,4,28,16777215);this.load.on("progress",(t=>{e.width=4+460*t}))}preload(){this.load.setPath("assets"),this.load.image("tiles","tilemap-template-32px-grid-dark.png"),this.load.tilemapTiledJSON("map","office.json"),this.load.spritesheet("duck","ducky_2_spritesheet.png",{frameWidth:32,frameHeight:32})}create(){this.scene.start("Intro")}}const h={type:s.AUTO,width:1024,height:768,audio:{disableWebAudio:!0},physics:{default:"arcade",arcade:{debug:!1}},parent:"game-container",backgroundColor:"limegreen",scale:{mode:Phaser.Scale.FIT,autoCenter:Phaser.Scale.CENTER_BOTH},scene:[a,n,o,r]};document.addEventListener("DOMContentLoaded",(()=>{new s.Game({...h,parent:"game-container"})}));
